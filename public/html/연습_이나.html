<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ƒê·ªÅ √¥n t·∫≠p (Ïù¥)ÎÇò - 30 C√¢u (C√≥ ph√≠m t·∫Øt)</title>
    <!-- Import Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Import Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        kr: ['Noto Sans KR', 'sans-serif'],
                    },
                    colors: {
                        primary: '#d97706', // Amber 600
                        primaryDark: '#b45309', // Amber 700
                        secondary: '#10b981', // Emerald 500
                        wrong: '#EF4444', // Red 500
                    }
                }
            }
        }
    </script>
    <style>
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #c7c7c7; border-radius: 4px; }
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        
        .palette-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(35px, 1fr));
            gap: 8px;
        }
        
        /* Keyboard hint style */
        .kbd {
            background-color: #eee;
            border-radius: 3px;
            border: 1px solid #b4b4b4;
            box-shadow: 0 1px 1px rgba(0,0,0,.2), 0 2px 0 0 rgba(255,255,255,.7) inset;
            color: #333;
            display: inline-block;
            font-size: 0.85em;
            font-weight: 700;
            line-height: 1;
            padding: 2px 4px;
            white-space: nowrap;
        }
    </style>
</head>
<body class="bg-slate-100 min-h-screen font-sans text-slate-800 p-4 md:p-8">

    <!-- Header -->
    <header class="max-w-4xl mx-auto bg-primary text-white p-4 rounded-xl shadow-lg mb-6 flex justify-between items-center">
        <div>
            <h1 class="text-xl md:text-2xl font-bold uppercase tracking-wide">Ng·ªØ ph√°p Ti·∫øng H√†n S∆° c·∫•p</h1>
            <p class="text-amber-100 text-xs md:text-sm">Chuy√™n ƒë·ªÅ: (Ïù¥)ÎÇò (30 c√¢u ch·ªçn l·ªçc)</p>
        </div>
        <div id="header-score" class="hidden text-right">
            <span class="text-xs text-amber-100 block">ƒêi·ªÉm s·ªë</span>
            <span class="text-2xl font-bold" id="current-score-display">0/30</span>
        </div>
    </header>

    <!-- Main Content Grid -->
    <div class="max-w-4xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-6">
        
        <!-- LEFT COLUMN: Quiz Area -->
        <div class="lg:col-span-8">
            <div class="bg-white rounded-2xl shadow-xl overflow-hidden min-h-[500px] flex flex-col relative">
                
                <!-- Progress Bar -->
                <div id="progress-container" class="w-full bg-gray-200 h-1 hidden">
                    <div id="progress-bar" class="bg-secondary h-1 transition-all duration-300" style="width: 0%"></div>
                </div>

                <main class="flex-1 p-6 flex flex-col justify-center relative">
                    
                    <!-- 1. Start Screen -->
                    <div id="start-screen" class="text-center space-y-6 fade-in py-10">
                        <div class="w-20 h-20 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-4xl">‚öñÔ∏è</span>
                        </div>
                        <h2 class="text-2xl font-bold text-gray-800">√în t·∫≠p (Ïù¥)ÎÇò</h2>
                        <div class="max-w-md mx-auto bg-slate-50 p-5 rounded-xl border border-slate-200 text-left text-sm text-gray-600 space-y-3">
                            <p>‚úÖ <strong>S·ªë l∆∞·ª£ng:</strong> 30 c√¢u.</p>
                            <p>‚úÖ <strong>N·ªôi dung:</strong> 3 √Ω nghƒ©a c·ªßa (Ïù¥)ÎÇò v√† ph√¢n bi·ªát v·ªõi c√°c tr·ª£ t·ª´ kh√°c.</p>
                            <p>‚å®Ô∏è <strong>Ph√≠m t·∫Øt:</strong> <span class="kbd">1</span> <span class="kbd">2</span> <span class="kbd">3</span> <span class="kbd">4</span> ch·ªçn ƒë√°p √°n, <span class="kbd">Enter</span> ti·∫øp theo, <span class="kbd">Ctrl</span>+<span class="kbd">Z</span> quay l·∫°i.</p>
                        </div>
                        <button onclick="app.startQuiz()" class="px-8 py-4 bg-primary hover:bg-primaryDark text-white font-bold rounded-xl shadow-lg transition transform hover:scale-[1.02]">
                            B·∫Øt ƒë·∫ßu l√†m b√†i (Enter)
                        </button>
                    </div>

                    <!-- 2. Quiz Screen -->
                    <div id="quiz-screen" class="hidden flex flex-col h-full fade-in">
                        <div class="flex justify-end items-center mb-4 text-sm font-semibold text-gray-500">
                            <span id="question-counter">C√¢u 1/30</span>
                        </div>

                        <div class="mb-6 min-h-[80px]">
                            <h3 id="question-text" class="text-xl md:text-2xl font-bold text-gray-800 font-kr leading-relaxed"></h3>
                        </div>

                        <div id="options-container" class="grid grid-cols-1 gap-3 mb-6"></div>

                        <div id="feedback-area" class="hidden bg-slate-50 border-l-4 p-4 rounded-r-lg shadow-sm mb-6 transition-all">
                            <div id="feedback-status" class="font-bold text-lg mb-1"></div>
                            <div class="text-gray-700 text-sm space-y-2">
                                <p><span class="font-semibold text-primary">D·ªãch nghƒ©a:</span> <span id="feedback-translation"></span></p>
                                <p><span class="font-semibold text-primary">Gi·∫£i th√≠ch:</span> <span id="feedback-explanation"></span></p>
                                <div class="bg-white p-2 rounded border border-gray-200 mt-2">
                                    <span class="text-xs font-bold text-gray-500 uppercase block mb-1">T·ª´ v·ª±ng & Ngu·ªìn g·ªëc</span>
                                    <p id="feedback-hanviet" class="text-gray-600"></p>
                                </div>
                            </div>
                        </div>

                        <div class="mt-auto flex gap-3 pt-4 border-t border-gray-100">
                            <button id="prev-btn" onclick="app.prevQuestion()" class="flex-1 py-3 bg-gray-100 hover:bg-gray-200 text-gray-700 font-bold rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed">‚¨Ö C√¢u tr∆∞·ªõc (Ctrl+Z)</button>
                            <button id="next-btn" onclick="app.nextQuestion()" class="flex-1 py-3 bg-primary hover:bg-primaryDark text-white font-bold rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed">C√¢u sau (Enter) ‚û°</button>
                        </div>
                    </div>

                    <!-- 3. Result Screen -->
                    <div id="result-screen" class="hidden text-center space-y-6 fade-in py-10">
                        <div class="w-24 h-24 mx-auto rounded-full flex items-center justify-center text-5xl shadow-lg bg-white" id="result-icon">üèÖ</div>
                        <h2 class="text-3xl font-bold text-gray-800">K·∫øt qu·∫£</h2>
                        <div class="text-6xl font-black text-primary" id="final-score">0/30</div>
                        <p class="text-gray-600 text-lg" id="result-message">ƒêang t·∫£i...</p>
                        <div class="grid grid-cols-2 gap-4 text-sm max-w-xs mx-auto">
                            <div class="bg-green-50 p-4 rounded-xl border border-green-200">
                                <span class="block text-green-600 font-bold text-2xl" id="correct-count">0</span>
                                <span class="text-gray-500">C√¢u ƒë√∫ng</span>
                            </div>
                            <div class="bg-red-50 p-4 rounded-xl border border-red-200">
                                <span class="block text-red-600 font-bold text-2xl" id="wrong-count">0</span>
                                <span class="text-gray-500">C√¢u sai</span>
                            </div>
                        </div>
                        <button onclick="app.restartQuiz()" class="px-8 py-4 bg-gray-800 hover:bg-gray-900 text-white font-bold rounded-xl shadow-lg transition mt-6">L√†m l·∫°i t·ª´ ƒë·∫ßu (Enter)</button>
                    </div>

                </main>
            </div>
        </div>

        <!-- RIGHT COLUMN: Question Palette -->
        <div class="lg:col-span-4" id="sidebar-container">
            <div class="bg-white rounded-2xl shadow-xl p-6 sticky top-6">
                <h3 class="font-bold text-gray-700 mb-4 flex items-center"><span class="mr-2">üß©</span> Danh s√°ch c√¢u h·ªèi</h3>
                <div class="flex gap-2 text-xs mb-4 flex-wrap">
                    <div class="flex items-center"><span class="w-3 h-3 bg-gray-100 border border-gray-300 rounded mr-1"></span> Ch∆∞a l√†m</div>
                    <div class="flex items-center"><span class="w-3 h-3 bg-primary text-white rounded mr-1"></span> ƒêang ch·ªçn</div>
                    <div class="flex items-center"><span class="w-3 h-3 bg-green-500 rounded mr-1"></span> ƒê√∫ng</div>
                    <div class="flex items-center"><span class="w-3 h-3 bg-red-500 rounded mr-1"></span> Sai</div>
                </div>
                <div id="palette-grid" class="palette-grid max-h-[400px] lg:max-h-[calc(100vh-250px)] overflow-y-auto pr-2">
                    <div class="text-gray-400 text-sm italic">B·∫Øt ƒë·∫ßu b√†i thi ƒë·ªÉ xem...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // D·ªÆ LI·ªÜU 30 C√ÇU H·ªéI (ƒê√É S·ª¨A L·ªñI NG·ªÆ PH√ÅP & T·ª™ V·ª∞NG)
        const questionData = [
            // --- NGHƒ®A 1: L·ª∞A CH·ªåN (HO·∫∂C) ---
            { q: "ÏïÑÏπ®Ïóê Îπµ_______ Î∞•ÏùÑ Î®πÏñ¥Ïöî.", options: ["Ïù¥ÎÇò", "ÎÇò", "ÎèÑ", "ÏùÄ"], a: 0, trans: "Bu·ªïi s√°ng t√¥i ƒÉn b√°nh m√¨ ho·∫∑c c∆°m.", expl: "L·ª±a ch·ªçn A ho·∫∑c B. 'Îπµ' c√≥ patchim -> d√πng 'Ïù¥ÎÇò'.", hv: "Îπµ ‚Üí B√°nh m√¨ (G·ªëc Ph√°p)." },
            { q: "Ïª§Ìîº_______ Ï∞®Î•º ÎßàÏÖîÏöî.", options: ["ÎÇò", "Ïù¥ÎÇò", "Î•º", "Í∞Ä"], a: 0, trans: "T√¥i u·ªëng c√† ph√™ ho·∫∑c tr√†.", expl: "L·ª±a ch·ªçn ƒë·ªì u·ªëng. 'Ïª§Ìîº' kh√¥ng patchim -> d√πng 'ÎÇò'.", hv: "Ï∞® [Tr√†] ‚Üí Tr√†." },
            { q: "ÏÇ¨Í≥º_______ Î∞∞Î•º Ï£ºÏÑ∏Ïöî.", options: ["ÎÇò", "Ïù¥ÎÇò", "Î•º", "Í∞Ä"], a: 0, trans: "Cho t√¥i t√°o ho·∫∑c l√™.", expl: "'ÏÇ¨Í≥º' kh√¥ng patchim -> d√πng 'ÎÇò'.", hv: "Î∞∞ ‚Üí L√™ (T·ª´ thu·∫ßn H√†n)." },
            { q: "ÏÇ∞_______ Î∞îÎã§Ïóê Í∞ÄÍ≥† Ïã∂Ïñ¥Ïöî.", options: ["Ïù¥ÎÇò", "ÎÇò", "Ïóê", "ÏóêÏÑú"], a: 0, trans: "T√¥i mu·ªën ƒëi n√∫i ho·∫∑c ƒëi bi·ªÉn.", expl: "L·ª±a ch·ªçn ƒë·ªãa ƒëi·ªÉm. 'ÏÇ∞' c√≥ patchim -> d√πng 'Ïù¥ÎÇò'.", hv: "ÏÇ∞ [S∆°n] ‚Üí N√∫i." },
            { q: "Î≤ÑÏä§_______ ÏßÄÌïòÏ≤†ÏùÑ ÌÉÄÏöî.", options: ["ÎÇò", "Ïù¥ÎÇò", "Í∞Ä", "Î•º"], a: 0, trans: "T√¥i ƒëi xe bu√Ωt ho·∫∑c t√†u ƒëi·ªán ng·∫ßm.", expl: "L·ª±a ch·ªçn ph∆∞∆°ng ti·ªán. 'Î≤ÑÏä§' kh√¥ng patchim -> d√πng 'ÎÇò'.", hv: "Î≤ÑÏä§ ‚Üí Xe bu√Ωt (G·ªëc Anh)." },
            { q: "ÌÜ†ÏöîÏùº_______ ÏùºÏöîÏùºÏóê ÎßåÎÇòÏöî.", options: ["Ïù¥ÎÇò", "ÎÇò", "Ïóê", "ÎèÑ"], a: 0, trans: "G·∫∑p nhau v√†o th·ª© B·∫£y ho·∫∑c Ch·ªß Nh·∫≠t nh√©.", expl: "L·ª±a ch·ªçn th·ªùi gian. 'ÌÜ†ÏöîÏùº' c√≥ patchim -> d√πng 'Ïù¥ÎÇò'.", hv: "ÌÜ†ÏöîÏùº [Th·ªï Di·ªáu Nh·∫≠t] ‚Üí Th·ª© B·∫£y." },
            { q: "Î≥ºÌéú_______ Ïó∞ÌïÑ ÏûàÏñ¥Ïöî?", options: ["Ïù¥ÎÇò", "ÎÇò", "ÏùÄ", "Ïù¥"], a: 0, trans: "B·∫°n c√≥ b√∫t bi ho·∫∑c b√∫t ch√¨ kh√¥ng?", expl: "L·ª±a ch·ªçn ƒë·ªì v·∫≠t. 'Î≥ºÌéú' c√≥ patchim -> d√πng 'Ïù¥ÎÇò'.", hv: "Î≥ºÌéú ‚Üí B√∫t bi (G·ªëc Anh)." },
            { q: "ÏòÅÏñ¥_______ ÌïúÍµ≠Ïñ¥Î•º Í≥µÎ∂ÄÌï¥Ïöî.", options: ["ÎÇò", "Ïù¥ÎÇò", "Î•º", "Í∞Ä"], a: 0, trans: "T√¥i h·ªçc ti·∫øng Anh ho·∫∑c ti·∫øng H√†n.", expl: "'ÏòÅÏñ¥' kh√¥ng patchim -> d√πng 'ÎÇò'.", hv: "ÏòÅÏñ¥ [Anh Ng·ªØ] ‚Üí Ti·∫øng Anh." },
            { q: "Î¨∏Ïûê_______ Ï†ÑÌôîÎ•º ÌïòÏÑ∏Ïöî.", options: ["ÎÇò", "Ïù¥ÎÇò", "Î•º", "Í∞Ä"], a: 0, trans: "H√£y nh·∫Øn tin ho·∫∑c g·ªçi ƒëi·ªán.", expl: "'Î¨∏Ïûê' kh√¥ng patchim -> d√πng 'ÎÇò'.", hv: "Î¨∏Ïûê [VƒÉn T·ª±] ‚Üí Tin nh·∫Øn." },
            { q: "Î∞îÏßÄ_______ ÏπòÎßàÎ•º ÏûÖÏñ¥Ïöî.", options: ["ÎÇò", "Ïù¥ÎÇò", "Î•º", "ÎèÑ"], a: 0, trans: "T√¥i m·∫∑c qu·∫ßn ho·∫∑c v√°y.", expl: "'Î∞îÏßÄ' kh√¥ng patchim -> d√πng 'ÎÇò'.", hv: "Î∞îÏßÄ ‚Üí Qu·∫ßn (T·ª´ thu·∫ßn H√†n)." },

            // --- NGHƒ®A 2: S·ªê L∆Ø·ª¢NG (T·∫¨N/NH·ªÆNG - NG·∫†C NHI√äN) vs B·∫ÆT BU·ªòC PH·ª¶ ƒê·ªäNH (B·∫ÆC K√ä) ---
            { q: "Ïñ¥Ï†ú Ïà†ÏùÑ 5Î≥ë_______ ÎßàÏÖ®Ïñ¥Ïöî. (ÎÑàÎ¨¥ ÎßéÏïÑÏöî)", options: ["Ïù¥ÎÇò", "Î∞ñÏóê", "Îßå", "ÎèÑ"], a: 0, trans: "H√¥m qua t√¥i ƒë√£ u·ªëng T·∫¨N 5 chai r∆∞·ª£u.", expl: "Nh·∫•n m·∫°nh s·ªë l∆∞·ª£ng nhi·ªÅu h∆°n mong ƒë·ª£i -> d√πng 'Ïù¥ÎÇò'.", hv: "Î≥ë [B√¨nh] ‚Üí Chai." },
            { q: "ÏπúÍµ¨Î•º 2ÏãúÍ∞Ñ_______ Í∏∞Îã§Î†∏Ïñ¥Ïöî. (ÌôîÍ∞Ä ÎÇòÏöî)", options: ["Ïù¥ÎÇò", "Î∞ñÏóê", "Îßå", "ÎèÑ"], a: 0, trans: "T√¥i ƒë√£ ƒë·ª£i b·∫°n T·∫¨N 2 ti·∫øng ƒë·ªìng h·ªì.", expl: "Th·ªùi gian ch·ªù ƒë·ª£i l√¢u -> d√πng 'Ïù¥ÎÇò'.", hv: "ÏãúÍ∞Ñ [Th·ªùi Gian] ‚Üí Ti·∫øng." },
            { q: "Ïñ¥Ï†ú 12ÏãúÍ∞Ñ_______ Ïû§Ïñ¥Ïöî.", options: ["Ïù¥ÎÇò", "Î∞ñÏóê", "Îßå", "ÎèÑ"], a: 0, trans: "H√¥m qua t√¥i ng·ªß T·∫¨N 12 ti·∫øng.", expl: "Ng·ªß nhi·ªÅu -> d√πng 'Ïù¥ÎÇò'.", hv: "ÏûêÎã§ ‚Üí Ng·ªß (T·ª´ thu·∫ßn H√†n)." },
            { q: "ÏÇ¨Í≥ºÍ∞Ä Ìïú Í∞úÏóê 5Ï≤ú Ïõê_______ Ìï¥Ïöî. (ÎπÑÏã∏Ïöî)", options: ["Ïù¥ÎÇò", "Î∞ñÏóê", "Îßå", "ÎèÑ"], a: 0, trans: "T√°o gi√° T·∫¨N 5.000 won m·ªôt qu·∫£.", expl: "Gi√° c·∫£ ƒë·∫Øt ƒë·ªè -> d√πng 'Ïù¥ÎÇò'.", hv: "Ïõê [Won] ‚Üí Won." },
            { q: "ÌååÌã∞Ïóê ÏÇ¨ÎûåÏù¥ 100Î™Ö_______ ÏôîÏñ¥Ïöî.", options: ["Ïù¥ÎÇò", "Î∞ñÏóê", "Îßå", "ÎèÑ"], a: 0, trans: "C√≥ T·∫¨N 100 ng∆∞·ªùi ƒë·∫øn b·ªØa ti·ªác.", expl: "S·ªë l∆∞·ª£ng ng∆∞·ªùi ƒë√¥ng b·∫•t ng·ªù -> d√πng 'Ïù¥ÎÇò'.", hv: "Î™Ö [Danh] ‚Üí Ng∆∞·ªùi (ƒë∆°n v·ªã ƒë·∫øm)." },
            { q: "ÏãúÍ∞ÑÏù¥ 5Î∂Ñ_______ Ïïà ÎÇ®ÏïòÏñ¥Ïöî.", options: ["Î∞ñÏóê", "Ïù¥ÎÇò", "Îßå", "ÎèÑ"], a: 0, trans: "Th·ªùi gian ch·ªâ c√≤n 5 ph√∫t.", expl: "S·ªë l∆∞·ª£ng √≠t + ph·ªß ƒë·ªãnh (Ïïà) -> d√πng 'Î∞ñÏóê'.", hv: "Î∂Ñ [Ph√¢n] ‚Üí Ph√∫t." },
            { q: "ÍµêÏã§Ïóê ÌïôÏÉùÏù¥ Ìïú Î™Ö_______ Ïïà ÏôîÏñ¥Ïöî.", options: ["Î∞ñÏóê", "Ïù¥ÎÇò", "Îßå", "ÎèÑ"], a: 0, trans: "Trong l·ªõp ch·ªâ c√≥ 1 h·ªçc sinh ƒë·∫øn.", expl: "S·ªë l∆∞·ª£ng √≠t + ph·ªß ƒë·ªãnh (Ïïà ÏôîÎã§) -> d√πng 'Î∞ñÏóê'.", hv: "ÌïôÏÉù [H·ªçc Sinh] ‚Üí H·ªçc sinh." },
            { q: "Ïñ¥Ï†ú 3ÏãúÍ∞Ñ_______ Î™ª Ïû§Ïñ¥Ïöî.", options: ["Î∞ñÏóê", "Ïù¥ÎÇò", "Îßå", "ÎèÑ"], a: 0, trans: "H√¥m qua t√¥i ng·ªß ƒë∆∞·ª£c c√≥ 3 ti·∫øng.", expl: "Ng·ªß √≠t + ph·ªß ƒë·ªãnh (Î™ª) -> d√πng 'Î∞ñÏóê'.", hv: "ÏãúÍ∞Ñ [Th·ªùi Gian] ‚Üí Ti·∫øng." },
            { q: "ÎèàÏù¥ Ï≤ú Ïõê_______ ÏóÜÏñ¥Ïöî.", options: ["Î∞ñÏóê", "Ïù¥ÎÇò", "Îßå", "ÎèÑ"], a: 0, trans: "Ti·ªÅn ch·ªâ c√≤n m·ªói 1.000 won.", expl: "S·ªë l∆∞·ª£ng √≠t + ƒëu√¥i ph·ªß ƒë·ªãnh (ÏóÜÎã§) -> d√πng 'Î∞ñÏóê'.", hv: "Ï≤ú [Thi√™n] ‚Üí Ngh√¨n." },
            { q: "Ï†ÄÎäî ÌïúÍµ≠Ïñ¥Î•º Ï°∞Í∏à_______ Î™ªÌï¥Ïöî.", options: ["Î∞ñÏóê", "Ïù¥ÎÇò", "Îßå", "ÎèÑ"], a: 0, trans: "T√¥i ch·ªâ n√≥i ƒë∆∞·ª£c m·ªôt ch√∫t ti·∫øng H√†n th√¥i.", expl: "Kh·∫£ nƒÉng gi·ªõi h·∫°n + ph·ªß ƒë·ªãnh (Î™ªÌïòÎã§) -> d√πng 'Î∞ñÏóê'.", hv: "Ï°∞Í∏à ‚Üí M·ªôt ch√∫t (T·ª´ thu·∫ßn H√†n)." },

            // --- NGHƒ®A 3: G·ª¢I √ù (HAY L√Ä... T·∫†M) vs C√ÇU TR·∫¶N THU·∫¨T ---
            { q: "Ïã¨Ïã¨Ìï¥Ïöî. ÏòÅÌôî_______ Î≥ºÍπåÏöî?", options: ["ÎÇò", "Î•º", "Í∞Ä", "ÎèÑ"], a: 0, trans: "Bu·ªìn ch√°n qu√°. Hay l√† xem phim ƒëi?", expl: "G·ª£i √Ω gi·∫£i t·ªèa s·ª± ch√°n ch∆∞·ªùng -> d√πng 'ÎÇò'.", hv: "ÏòÅÌôî [√Ånh H·ªça] ‚Üí Phim." },
            { q: "ÏãúÍ∞ÑÏù¥ ÏûàÏñ¥Ïöî. ÏÑúÏ†ê_______ Í∞ÄÏöî.", options: ["Ïù¥ÎÇò", "Ïóê", "ÏóêÏÑú", "Î∂ÄÌÑ∞"], a: 0, trans: "C√≥ th·ªùi gian r·∫£nh. Hay l√† ƒëi hi·ªáu s√°ch ƒëi.", expl: "G·ª£i √Ω ƒë·ªãa ƒëi·ªÉm gi·∫øt th·ªùi gian -> d√πng 'Ïù¥ÎÇò'.", hv: "ÏÑúÏ†ê [Th∆∞ ƒêi·∫øm] ‚Üí Hi·ªáu s√°ch." },
            { q: "Î∞∞Í∞Ä Í≥†ÌååÏöî. ÎùºÎ©¥_______ Î®πÏñ¥Ïöî.", options: ["Ïù¥ÎÇò", "ÏùÑ", "Ïù¥", "ÎèÑ"], a: 0, trans: "ƒê√≥i b·ª•ng qu√°. Hay l√† ƒÉn m√¨ g√≥i ƒë·ª° ƒëi.", expl: "G·ª£i √Ω m√≥n ƒÉn thay th·∫ø/ƒë∆°n gi·∫£n -> d√πng 'Ïù¥ÎÇò'.", hv: "ÎùºÎ©¥ ‚Üí M√¨ g√≥i." },
            { q: "Î™©Ïù¥ ÎßêÎùºÏöî. Î¨º_______ ÎßàÏã≠ÏãúÎã§.", options: ["Ïù¥ÎÇò", "ÏùÑ", "Í∞Ä", "Îäî"], a: 0, trans: "Kh√°t n∆∞·ªõc qu√°. U·ªëng n∆∞·ªõc t·∫°m nh√©.", expl: "G·ª£i √Ω gi·∫£i kh√°t -> d√πng 'Ïù¥ÎÇò'.", hv: "Î¨º ‚Üí N∆∞·ªõc (T·ª´ thu·∫ßn H√†n)." },
            { q: "Î∞•Ïù¥ ÏóÜÏñ¥Ïöî. Îπµ_______ ÎìúÏÑ∏Ïöî.", options: ["Ïù¥ÎÇò", "ÏùÑ", "Î•º", "ÎèÑ"], a: 0, trans: "H·∫øt c∆°m r·ªìi. ƒÇn t·∫°m b√°nh m√¨ ƒëi ·∫°.", expl: "Ph∆∞∆°ng √°n thay th·∫ø -> d√πng 'Ïù¥ÎÇò'.", hv: "Î∞• ‚Üí C∆°m (T·ª´ thu·∫ßn H√†n)." },
            { q: "Ìï† ÏùºÏù¥ ÏóÜÏñ¥Ïöî. Ïû†_______ ÏûêÏöî.", options: ["Ïù¥ÎÇò", "ÏùÑ", "Ïù¥", "Í∞Ä"], a: 0, trans: "Kh√¥ng c√≥ vi·ªác g√¨ l√†m. Ng·ªß ƒë·∫°i ƒëi.", expl: "G·ª£i √Ω h√†nh ƒë·ªông khi r·∫£nh -> d√πng 'Ïù¥ÎÇò'.", hv: "Ïû† ‚Üí Gi·∫•c ng·ªß (T·ª´ thu·∫ßn H√†n)." },
            { q: "ÌîºÍ≥§Ìï¥Ïöî. Ï∞úÏßàÎ∞©_______ Í∞ÄÏöî.", options: ["Ïù¥ÎÇò", "Ïóê", "ÏóêÏÑú", "ÏùÑ"], a: 0, trans: "M·ªát qu√°. Hay l√† ƒëi ph√≤ng x√¥ng h∆°i ƒëi.", expl: "G·ª£i √Ω gi·∫£i ph√°p cho s·ª± m·ªát m·ªèi -> d√πng 'Ïù¥ÎÇò'.", hv: "ÌîºÍ≥§ÌïòÎã§ [B√¨ Kh·ªën -] ‚Üí M·ªát m·ªèi." },
            { q: "ÎèàÏù¥ ÏóÜÏñ¥Ïöî. Í≥µÏõê_______ Í∞ëÏãúÎã§.", options: ["Ïù¥ÎÇò", "Ïóê", "ÏóêÏÑú", "Î°ú"], a: 0, trans: "Kh√¥ng c√≥ ti·ªÅn. Hay l√† ra c√¥ng vi√™n ƒëi.", expl: "L·ª±a ch·ªçn ph√π h·ª£p ho√†n c·∫£nh -> d√πng 'Ïù¥ÎÇò'.", hv: "Í≥µÏõê [C√¥ng Vi√™n] ‚Üí C√¥ng vi√™n." },
            { q: "Ï†ÄÎäî Ïñ¥Ï†ú ÌïòÎ£® Ï¢ÖÏùº Í≤åÏûÑ_______ ÌñàÏñ¥Ïöî.", options: ["ÏùÑ", "Ïù¥ÎÇò", "Ïù¥", "Í∞Ä"], a: 0, trans: "H√¥m qua t√¥i ƒë√£ ch∆°i game c·∫£ ng√†y.", expl: "T∆∞·ªùng thu·∫≠t h√†nh ƒë·ªông c·ª• th·ªÉ ƒë√£ l√†m -> d√πng t√¢n ng·ªØ 'ÏùÑ'.", hv: "ÌïòÎ£® Ï¢ÖÏùº ‚Üí C·∫£ ng√†y (T·ª´ thu·∫ßn H√†n)." },
            { q: "Ï†ÄÎäî ÎÇ¥Ïùº ÏÑúÏ†ê_______ Í∞ÄÏöî. (Í≥ÑÌöç)", options: ["Ïóê", "Ïù¥ÎÇò", "ÏóêÏÑú", "Î∂ÄÌÑ∞"], a: 0, trans: "Ng√†y mai t√¥i ƒëi hi·ªáu s√°ch.", expl: "K·∫ø ho·∫°ch/ƒê√≠ch ƒë·∫øn c·ª• th·ªÉ -> d√πng 'Ïóê'.", hv: "ÎÇ¥Ïùº [Lai Nh·∫≠t] ‚Üí Ng√†y mai." }
        ];

        const app = {
            currentIndex: 0,
            score: 0,
            shuffledQuestions: [],
            userAnswers: [], 
            answerStatus: [], 

            startQuiz: function() {
                // VI: RANDOM (X√ÅO TR·ªòN) TH·ª® T·ª∞ C√ÇU H·ªéI M·ªñI L·∫¶N B·∫ÆT ƒê·∫¶U
                // VI: M·ªói l·∫ßn b·∫•m "B·∫Øt ƒë·∫ßu", danh s√°ch c√¢u s·∫Ω ƒë∆∞·ª£c tr·ªôn l·∫°i ƒë·ªÉ luy·ªán t·∫≠p ƒëa d·∫°ng h∆°n.
                this.shuffledQuestions = [...questionData].sort(() => Math.random() - 0.5);
                this.currentIndex = 0;
                this.score = 0;
                this.userAnswers = new Array(this.shuffledQuestions.length).fill(null);
                this.answerStatus = new Array(this.shuffledQuestions.length).fill(null);

                document.getElementById('start-screen').classList.add('hidden');
                document.getElementById('quiz-screen').classList.remove('hidden');
                document.getElementById('progress-container').classList.remove('hidden');
                document.getElementById('header-score').classList.remove('hidden');
                document.getElementById('sidebar-container').classList.remove('hidden');
                
                this.renderPalette();
                this.showQuestion();
            },

            showQuestion: function() {
                const qData = this.shuffledQuestions[this.currentIndex];
                const total = this.shuffledQuestions.length;
                
                document.getElementById('question-counter').innerText = `C√¢u ${this.currentIndex + 1}/${total}`;
                document.getElementById('question-text').innerText = qData.q;
                
                const progressPercent = ((this.currentIndex + 1) / total) * 100;
                document.getElementById('progress-bar').style.width = `${progressPercent}%`;
                document.getElementById('current-score-display').innerText = `${this.score}/${total}`;

                const optionsContainer = document.getElementById('options-container');
                optionsContainer.innerHTML = '';

                const hasAnswered = this.userAnswers[this.currentIndex] !== null;

                qData.options.forEach((opt, index) => {
                    const btn = document.createElement('button');
                    btn.className = "w-full text-left p-4 rounded-xl border-2 border-gray-200 hover:border-amber-400 hover:bg-amber-50 font-medium text-lg transition-all duration-200 flex items-center";
                    btn.innerHTML = `<span class="w-8 h-8 rounded-full bg-gray-100 text-gray-500 flex items-center justify-center mr-3 text-sm font-bold">${String.fromCharCode(65+index)}</span> ${opt}`;
                    
                    if (hasAnswered) {
                        btn.disabled = true;
                        btn.classList.add('cursor-not-allowed', 'opacity-80');
                        btn.classList.remove('hover:border-amber-400', 'hover:bg-amber-50');
                        
                        if (index === qData.a) {
                            this.applyCorrectStyle(btn);
                        } else if (index === this.userAnswers[this.currentIndex]) {
                            this.applyWrongStyle(btn);
                        }
                    } else {
                        btn.onclick = () => this.selectAnswer(index, btn);
                    }
                    
                    optionsContainer.appendChild(btn);
                });

                const feedbackArea = document.getElementById('feedback-area');
                if (hasAnswered) {
                    feedbackArea.classList.remove('hidden');
                    const isCorrect = this.answerStatus[this.currentIndex] === 'correct';
                    const statusDiv = document.getElementById('feedback-status');
                    
                    if (isCorrect) {
                        statusDiv.innerHTML = "<span class='text-green-600'>‚úÖ Ch√≠nh x√°c!</span>";
                        feedbackArea.classList.remove('border-l-red-500');
                        feedbackArea.classList.add('border-l-green-500');
                    } else {
                        statusDiv.innerHTML = "<span class='text-red-600'>‚ùå Sai r·ªìi!</span>";
                        feedbackArea.classList.remove('border-l-green-500');
                        feedbackArea.classList.add('border-l-red-500');
                    }
                    
                    document.getElementById('feedback-translation').innerText = qData.trans;
                    document.getElementById('feedback-explanation').innerText = qData.expl;
                    document.getElementById('feedback-hanviet').innerText = qData.hv;
                } else {
                    feedbackArea.classList.add('hidden');
                }

                document.getElementById('prev-btn').disabled = (this.currentIndex === 0);
                document.getElementById('next-btn').disabled = (this.currentIndex === total - 1);
                
                this.updatePaletteHighlight();
            },

            applyCorrectStyle: function(btn) {
                btn.classList.remove('border-gray-200');
                btn.classList.add('bg-green-100', 'border-green-500', 'text-green-800');
                btn.querySelector('span').classList.add('bg-green-200', 'text-green-800');
            },

            applyWrongStyle: function(btn) {
                btn.classList.remove('border-gray-200');
                btn.classList.add('bg-red-100', 'border-red-500', 'text-red-800');
                btn.querySelector('span').classList.add('bg-red-200', 'text-red-800');
            },

            selectAnswer: function(selectedIndex, btnElement) {
                const qData = this.shuffledQuestions[this.currentIndex];
                this.userAnswers[this.currentIndex] = selectedIndex;
                
                const allButtons = document.getElementById('options-container').children;
                for (let btn of allButtons) {
                    btn.disabled = true;
                    btn.classList.add('cursor-not-allowed');
                    btn.classList.remove('hover:border-amber-400', 'hover:bg-amber-50');
                }

                if (selectedIndex === qData.a) {
                    this.score++;
                    this.answerStatus[this.currentIndex] = 'correct';
                    this.applyCorrectStyle(btnElement);
                } else {
                    this.answerStatus[this.currentIndex] = 'wrong';
                    this.applyWrongStyle(btnElement);
                    this.applyCorrectStyle(allButtons[qData.a]);
                }

                document.getElementById('current-score-display').innerText = `${this.score}/${this.shuffledQuestions.length}`;
                this.renderPalette();

                const feedbackArea = document.getElementById('feedback-area');
                const statusDiv = document.getElementById('feedback-status');
                
                feedbackArea.classList.remove('hidden');
                if (this.answerStatus[this.currentIndex] === 'correct') {
                    statusDiv.innerHTML = "<span class='text-green-600'>‚úÖ Ch√≠nh x√°c!</span>";
                    feedbackArea.classList.remove('border-l-red-500');
                    feedbackArea.classList.add('border-l-green-500');
                } else {
                    statusDiv.innerHTML = "<span class='text-red-600'>‚ùå Sai r·ªìi!</span>";
                    feedbackArea.classList.remove('border-l-green-500');
                    feedbackArea.classList.add('border-l-red-500');
                }

                document.getElementById('feedback-translation').innerText = qData.trans;
                document.getElementById('feedback-explanation').innerText = qData.expl;
                document.getElementById('feedback-hanviet').innerText = qData.hv;
                
                if (this.currentIndex === this.shuffledQuestions.length - 1 && this.userAnswers.every(a => a !== null)) {
                    setTimeout(() => this.showResults(), 1500);
                }
            },

            renderPalette: function() {
                const paletteContainer = document.getElementById('palette-grid');
                paletteContainer.innerHTML = '';

                this.shuffledQuestions.forEach((_, index) => {
                    const status = this.answerStatus[index];
                    const btn = document.createElement('button');
                    btn.innerText = index + 1;
                    btn.className = "h-9 w-full rounded font-bold text-sm transition flex items-center justify-center border ";
                    
                    if (index === this.currentIndex) {
                        btn.classList.add('ring-2', 'ring-amber-400', 'ring-offset-1');
                    }

                    if (status === 'correct') {
                        btn.classList.add('bg-green-500', 'text-white', 'border-green-600');
                    } else if (status === 'wrong') {
                        btn.classList.add('bg-red-500', 'text-white', 'border-red-600');
                    } else {
                        btn.classList.add('bg-gray-100', 'text-gray-500', 'border-gray-200', 'hover:bg-gray-200');
                    }

                    btn.onclick = () => this.jumpToQuestion(index);
                    paletteContainer.appendChild(btn);
                });
            },

            updatePaletteHighlight: function() {
                this.renderPalette();
            },

            prevQuestion: function() {
                if (this.currentIndex > 0) {
                    this.currentIndex--;
                    this.showQuestion();
                }
            },

            nextQuestion: function() {
                if (this.currentIndex < this.shuffledQuestions.length - 1) {
                    this.currentIndex++;
                    this.showQuestion();
                } else if (this.userAnswers.every(a => a !== null)) {
                    this.showResults();
                }
            },

            jumpToQuestion: function(index) {
                this.currentIndex = index;
                this.showQuestion();
            },

            showResults: function() {
                document.getElementById('quiz-screen').classList.add('hidden');
                document.getElementById('result-screen').classList.remove('hidden');
                document.getElementById('sidebar-container').classList.add('hidden');
                document.getElementById('header-score').classList.add('hidden');
                document.getElementById('progress-container').classList.add('hidden');

                const total = this.shuffledQuestions.length;
                const percent = Math.round((this.score / total) * 100);

                document.getElementById('final-score').innerText = `${this.score}/${total}`;
                document.getElementById('correct-count').innerText = this.score;
                document.getElementById('wrong-count').innerText = total - this.score;

                let message = "";
                if (percent === 100) message = "Tuy·ªát ƒë·ªëi! B·∫°n ƒë√£ n·∫Øm v·ªØng ng·ªØ ph√°p (Ïù¥)ÎÇò!";
                else if (percent >= 80) message = "Xu·∫•t s·∫Øc! B·∫°n ph√¢n bi·ªát r·∫•t t·ªët c√°c ng·ªØ c·∫£nh.";
                else if (percent >= 60) message = "Kh√° t·ªët! H√£y ch√∫ √Ω h∆°n ƒë·∫øn c√°c c√¢u ph·ªß ƒë·ªãnh.";
                else message = "C·∫ßn c·ªë g·∫Øng h∆°n! H√£y √¥n l·∫°i s·ª± kh√°c bi·ªát gi·ªØa (Ïù¥)ÎÇò v√† Î∞ñÏóê.";
                
                document.getElementById('result-message').innerText = message;
            },

            restartQuiz: function() {
                document.getElementById('result-screen').classList.add('hidden');
                this.startQuiz();
            }
        };

        // KEYBOARD SHORTCUTS
        document.addEventListener('keydown', function(event) {
            const startScreen = document.getElementById('start-screen');
            const quizScreen = document.getElementById('quiz-screen');
            const resultScreen = document.getElementById('result-screen');

            if (!startScreen.classList.contains('hidden')) {
                if (event.key === 'Enter') app.startQuiz();
            } else if (!resultScreen.classList.contains('hidden')) {
                if (event.key === 'Enter') app.restartQuiz();
            } else if (!quizScreen.classList.contains('hidden')) {
                const hasAnswered = app.userAnswers[app.currentIndex] !== null;

                if (event.key === '1' && !hasAnswered) app.selectAnswer(0, document.getElementById('options-container').children[0]);
                if (event.key === '2' && !hasAnswered) app.selectAnswer(1, document.getElementById('options-container').children[1]);
                if (event.key === '3' && !hasAnswered) app.selectAnswer(2, document.getElementById('options-container').children[2]);
                if (event.key === '4' && !hasAnswered) app.selectAnswer(3, document.getElementById('options-container').children[3]);

                if (event.key === 'Enter') app.nextQuestion();
                if (event.ctrlKey && (event.key === 'z' || event.key === 'Z')) {
                    event.preventDefault();
                    app.prevQuestion();
                }
            }
        });
    </script>
</body>
</html>