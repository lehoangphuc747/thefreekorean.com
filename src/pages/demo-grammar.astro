---
import Layout from '../layouts/Layout.astro';
import GrammarQuiz from '../components/grammar/GrammarQuiz.astro';
import GrammarProgress from '../components/grammar/GrammarProgress.astro';

const pageTitle = "Demo Grammar Components";
const pageDescription = "Trang demo ƒë·ªÉ test c√°c components ng·ªØ ph√°p m·ªõi";
---

<Layout title={pageTitle} description={pageDescription}>
  <!-- Page Header -->
  <div class="bg-gradient-to-r from-purple-600 to-blue-600 text-white py-16">
    <div class="container mx-auto px-4 text-center">
      <h1 class="text-4xl md:text-5xl font-bold mb-4">
        üß™ Demo Grammar Components
      </h1>
      <p class="text-xl md:text-2xl mb-8 max-w-3xl mx-auto leading-relaxed">
        Trang demo ƒë·ªÉ test v√† xem tr∆∞·ªõc c√°c components ng·ªØ ph√°p m·ªõi
      </p>
    </div>
  </div>

  <!-- Component Demos -->
  <main class="container mx-auto px-4 py-12">
    <!-- Quiz Demo Section -->
    <section class="mb-16">
      <div class="text-center mb-8">
        <h2 class="text-3xl font-bold text-gray-800 mb-4">üìù Grammar Quiz Component</h2>
        <p class="text-gray-600 text-lg">Interactive quiz system v·ªõi nhi·ªÅu lo·∫°i c√¢u h·ªèi</p>
      </div>
      
      <GrammarQuiz 
        grammarId="particles-e-wa"
        quizType="mixed"
        difficulty="beginner"
        questionCount={4}
        showProgress={true}
        showHints={true}
        showExplanations={true}
        timeLimit={0}
      />
    </section>

    <!-- Progress Demo Section -->
    <section class="mb-16">
      <div class="text-center mb-8">
        <h2 class="text-3xl font-bold text-gray-800 mb-4">üìä Grammar Progress Component</h2>
        <p class="text-gray-600 text-lg">Comprehensive progress tracking v·ªõi achievements v√† calendar</p>
      </div>
      
      <GrammarProgress 
        showDetailed={true}
        variant="full"
        userProgress={{
          totalGrammar: 8,
          completedGrammar: 3,
          currentStreak: 5,
          longestStreak: 12,
          totalStudyTime: 180,
          lastStudyDate: "2025-07-22",
          weeklyGoal: 5,
          achievements: ["first_lesson", "streak_7", "master_10"]
        }}
      />
    </section>

    <!-- Component Features -->
    <section class="mb-16">
      <div class="text-center mb-8">
        <h2 class="text-3xl font-bold text-gray-800 mb-4">‚ú® Features Overview</h2>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        <div class="bg-white rounded-xl shadow-lg p-6 border-l-4 border-blue-500">
          <div class="text-3xl mb-4">üéØ</div>
          <h3 class="text-xl font-bold text-gray-800 mb-2">Smart Quiz System</h3>
          <ul class="text-gray-600 space-y-1">
            <li>‚Ä¢ Multiple choice questions</li>
            <li>‚Ä¢ Fill in the blanks</li>
            <li>‚Ä¢ Sentence building</li>
            <li>‚Ä¢ Translation exercises</li>
            <li>‚Ä¢ Real-time scoring</li>
          </ul>
        </div>

        <div class="bg-white rounded-xl shadow-lg p-6 border-l-4 border-green-500">
          <div class="text-3xl mb-4">üìà</div>
          <h3 class="text-xl font-bold text-gray-800 mb-2">Progress Tracking</h3>
          <ul class="text-gray-600 space-y-1">
            <li>‚Ä¢ Learning statistics</li>
            <li>‚Ä¢ Achievement system</li>
            <li>‚Ä¢ Study calendar</li>
            <li>‚Ä¢ Streak tracking</li>
            <li>‚Ä¢ Performance analytics</li>
          </ul>
        </div>

        <div class="bg-white rounded-xl shadow-lg p-6 border-l-4 border-purple-500">
          <div class="text-3xl mb-4">üéÆ</div>
          <h3 class="text-xl font-bold text-gray-800 mb-2">Gamification</h3>
          <ul class="text-gray-600 space-y-1">
            <li>‚Ä¢ Level progression</li>
            <li>‚Ä¢ Badges & achievements</li>
            <li>‚Ä¢ Weekly goals</li>
            <li>‚Ä¢ Study streaks</li>
            <li>‚Ä¢ Interactive rewards</li>
          </ul>
        </div>

        <div class="bg-white rounded-xl shadow-lg p-6 border-l-4 border-orange-500">
          <div class="text-3xl mb-4">üß†</div>
          <h3 class="text-xl font-bold text-gray-800 mb-2">Adaptive Learning</h3>
          <ul class="text-gray-600 space-y-1">
            <li>‚Ä¢ Difficulty adjustment</li>
            <li>‚Ä¢ Personalized recommendations</li>
            <li>‚Ä¢ Weak point identification</li>
            <li>‚Ä¢ Study path optimization</li>
            <li>‚Ä¢ Performance feedback</li>
          </ul>
        </div>

        <div class="bg-white rounded-xl shadow-lg p-6 border-l-4 border-red-500">
          <div class="text-3xl mb-4">üíæ</div>
          <h3 class="text-xl font-bold text-gray-800 mb-2">Data Persistence</h3>
          <ul class="text-gray-600 space-y-1">
            <li>‚Ä¢ LocalStorage integration</li>
            <li>‚Ä¢ Progress synchronization</li>
            <li>‚Ä¢ Cross-session continuity</li>
            <li>‚Ä¢ Backup & restore</li>
            <li>‚Ä¢ Offline functionality</li>
          </ul>
        </div>

        <div class="bg-white rounded-xl shadow-lg p-6 border-l-4 border-cyan-500">
          <div class="text-3xl mb-4">üì±</div>
          <h3 class="text-xl font-bold text-gray-800 mb-2">Responsive Design</h3>
          <ul class="text-gray-600 space-y-1">
            <li>‚Ä¢ Mobile-first approach</li>
            <li>‚Ä¢ Touch-friendly interface</li>
            <li>‚Ä¢ Cross-platform compatibility</li>
            <li>‚Ä¢ Accessible design</li>
            <li>‚Ä¢ Performance optimized</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Navigation Links -->
    <section class="text-center">
      <div class="bg-gray-50 rounded-xl p-8">
        <h3 class="text-2xl font-bold text-gray-800 mb-6">üöÄ Explore More</h3>
        <div class="flex flex-wrap justify-center gap-4">
          <a href="/ngu-phap-moi" class="inline-flex items-center px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
            <span class="mr-2">üè†</span>
            New Grammar Dashboard
          </a>
          <a href="/ngu-phap" class="inline-flex items-center px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
            <span class="mr-2">üìö</span>
            Original Grammar Page
          </a>
          <a href="/documents" class="inline-flex items-center px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors">
            <span class="mr-2">üìñ</span>
            All Documents
          </a>
          <a href="/" class="inline-flex items-center px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors">
            <span class="mr-2">üè†</span>
            Homepage
          </a>
        </div>
      </div>
    </section>
  </main>
</Layout>

<style>
  /* Additional demo styles */
  .demo-section {
    background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
    border-radius: 16px;
    padding: 2rem;
    margin: 2rem 0;
  }

  /* Animated elements */
  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.8; }
  }

  .pulse {
    animation: pulse 2s infinite;
  }

  /* Interactive hover effects */
  .feature-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 28px rgba(0, 0, 0, 0.15);
  }

  /* Demo-specific responsive adjustments */
  @media (max-width: 768px) {
    .demo-section {
      padding: 1.5rem;
      margin: 1rem 0;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    console.log('üéâ Grammar Components Demo Page Loaded!');
    
    // Add some demo data to localStorage for testing
    const demoProgress = {
      totalGrammar: 8,
      completedGrammar: 3,
      currentStreak: 5,
      longestStreak: 12,
      totalStudyTime: 180,
      lastStudyDate: "2025-07-22",
      weeklyGoal: 5,
      achievements: ["first_lesson", "streak_7", "master_10"],
      studyDates: [
        "2025-07-18",
        "2025-07-19", 
        "2025-07-20",
        "2025-07-21",
        "2025-07-22"
      ]
    };

    const demoCompletedGrammars = [
      "particles-e-wa",
      "present-tense", 
      "past-tense"
    ];

    const demoQuizHistory = [
      {
        grammarId: "particles-e-wa",
        score: 8,
        total: 10,
        percentage: 80,
        timeSpent: 12,
        date: "2025-07-22T10:30:00.000Z",
        difficulty: "beginner",
        quizType: "mixed"
      },
      {
        grammarId: "present-tense",
        score: 9,
        total: 10,
        percentage: 90,
        timeSpent: 15,
        date: "2025-07-21T14:20:00.000Z", 
        difficulty: "beginner",
        quizType: "multiple-choice"
      },
      {
        grammarId: "past-tense",
        score: 7,
        total: 10,
        percentage: 70,
        timeSpent: 18,
        date: "2025-07-20T16:45:00.000Z",
        difficulty: "beginner", 
        quizType: "mixed"
      }
    ];

    // Set demo data in localStorage if not exists
    if (!localStorage.getItem('grammarProgress')) {
      localStorage.setItem('grammarProgress', JSON.stringify(demoProgress));
    }
    
    if (!localStorage.getItem('completedGrammars')) {
      localStorage.setItem('completedGrammars', JSON.stringify(demoCompletedGrammars));
    }
    
    if (!localStorage.getItem('quizHistory')) {
      localStorage.setItem('quizHistory', JSON.stringify(demoQuizHistory));
    }

    // Add interactive demo features
    let demoMode = false;
    
    // Toggle demo mode
    document.addEventListener('keydown', function(e) {
      if (e.key === 'D' && e.ctrlKey) {
        e.preventDefault();
        demoMode = !demoMode;
        
        if (demoMode) {
          showDemoOverlay();
        } else {
          hideDemoOverlay();
        }
      }
    });

    function showDemoOverlay() {
      const overlay = document.createElement('div');
      overlay.id = 'demo-overlay';
      overlay.className = 'fixed top-4 right-4 bg-blue-600 text-white p-4 rounded-lg shadow-lg z-50';
      overlay.innerHTML = `
        <div class="text-sm font-bold mb-2">üéÆ DEMO MODE</div>
        <div class="text-xs">
          ‚Ä¢ Press Ctrl+D to toggle<br>
          ‚Ä¢ All data is simulated<br>
          ‚Ä¢ LocalStorage enabled
        </div>
      `;
      document.body.appendChild(overlay);
      
      setTimeout(() => {
        overlay.style.animation = 'fadeIn 0.3s ease';
      }, 100);
    }

    function hideDemoOverlay() {
      const overlay = document.getElementById('demo-overlay');
      if (overlay) {
        overlay.remove();
      }
    }

    // Add demo tooltips
    const featureCards = document.querySelectorAll('.bg-white.rounded-xl.shadow-lg');
    featureCards.forEach((card, index) => {
      card.addEventListener('mouseenter', function() {
        if (demoMode) {
          const tooltip = document.createElement('div');
          tooltip.className = 'absolute -top-2 -left-2 bg-yellow-400 text-black text-xs px-2 py-1 rounded shadow-lg z-10';
          tooltip.textContent = `Feature ${index + 1} - Interactive Demo`;
          this.style.position = 'relative';
          this.appendChild(tooltip);
        }
      });
      
      card.addEventListener('mouseleave', function() {
        const tooltip = this.querySelector('.bg-yellow-400');
        if (tooltip) {
          tooltip.remove();
        }
      });
    });

    // Console welcome message
    console.log(`
    üöÄ Welcome to Grammar Components Demo!
    
    Available Components:
    ‚Ä¢ GrammarQuiz - Interactive quiz system
    ‚Ä¢ GrammarProgress - Progress tracking
    ‚Ä¢ GrammarDashboard - Complete learning hub
    ‚Ä¢ GrammarNavigation - Smart navigation
    ‚Ä¢ GrammarFilter - Advanced filtering
    
    Demo Controls:
    ‚Ä¢ Ctrl+D - Toggle demo mode
    ‚Ä¢ Check console for component logs
    ‚Ä¢ LocalStorage data is pre-populated
    
    Happy testing! üéâ
    `);
  });
</script>
