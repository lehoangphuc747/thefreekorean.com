---
import TopikLayout from '../../layouts/TopikLayout.astro';
import TopikGrid from '../../components/topik/TopikGrid.astro';
import TopikFilter from '../../components/topik/TopikFilter.astro';

// Import t√†i li·ªáu luy·ªán t·∫≠p TOPIK
const topikFiles = import.meta.glob('../../content/topik/*.mdx', { eager: true });

// L·ªçc ch·ªâ l·∫•y t√†i li·ªáu luy·ªán t·∫≠p
const practiceDocuments = Object.entries(topikFiles)
  .map(([path, module]: [string, any]) => ({
    slug: path.split('/').pop()?.replace('.mdx', '') || '',
    data: module.frontmatter,
    Content: module.default,
  }))
  .filter((doc) => doc.data.category === 'practice');

// S·∫Øp x·∫øp theo th·ª© t·ª± (n·∫øu c√≥ order) ho·∫∑c theo t√™n
practiceDocuments.sort((a, b) => {
  if (a.data.order && b.data.order) {
    return a.data.order - b.data.order;
  }
  return a.data.title.localeCompare(b.data.title, 'vi');
});

const categories = Array.from(new Set(practiceDocuments.map(doc => doc.data.topic || 'Kh√°c')));
---

<TopikLayout 
  title="Luy·ªán t·∫≠p TOPIK" 
  description="T√†i li·ªáu luy·ªán t·∫≠p TOPIK - Test of Proficiency in Korean"
>

  <!-- Hero Section -->
  <section class="relative overflow-hidden">
    <div class="absolute inset-0 bg-gradient-to-br from-blue-600/10 via-purple-600/5 to-pink-600/10"></div>
    <div class="relative max-w-7xl mx-auto px-4 py-16 text-center">
      
      <!-- Hero Icon -->
      <div class="mb-8">
        <div class="w-24 h-24 mx-auto bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center mb-6 shadow-xl">
          <span class="text-4xl">üìù</span>
        </div>
      </div>
      
      <!-- Hero Content -->
      <h1 class="text-4xl md:text-6xl font-bold text-gray-900 mb-6">
        <span class="bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">Luy·ªán t·∫≠p TOPIK</span>
      </h1>
      
      <p class="text-xl md:text-2xl text-gray-600 mb-8 max-w-3xl mx-auto leading-relaxed">
        √în t·∫≠p v√† n√¢ng cao k·ªπ nƒÉng ti·∫øng H√†n v·ªõi c√°c t√†i li·ªáu luy·ªán thi TOPIK ch·∫•t l∆∞·ª£ng cao
      </p>

      <!-- Stats -->
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4 max-w-4xl mx-auto mt-12">
        <div class="bg-white/80 backdrop-blur-sm rounded-xl p-6 shadow-lg border border-blue-100">
          <div class="text-3xl font-bold text-blue-600 mb-2">{practiceDocuments.length}</div>
          <div class="text-sm text-gray-600 font-semibold">T√†i li·ªáu</div>
        </div>
        <div class="bg-white/80 backdrop-blur-sm rounded-xl p-6 shadow-lg border border-purple-100">
          <div class="text-3xl font-bold text-purple-600 mb-2">{categories.length}</div>
          <div class="text-sm text-gray-600 font-semibold">Ch·ªß ƒë·ªÅ</div>
        </div>
        <div class="bg-white/80 backdrop-blur-sm rounded-xl p-6 shadow-lg border border-pink-100">
          <div class="text-3xl font-bold text-pink-600 mb-2">100%</div>
          <div class="text-sm text-gray-600 font-semibold">Mi·ªÖn ph√≠</div>
        </div>
        <div class="bg-white/80 backdrop-blur-sm rounded-xl p-6 shadow-lg border border-indigo-100">
          <div class="text-3xl font-bold text-indigo-600 mb-2">‚àû</div>
          <div class="text-sm text-gray-600 font-semibold">Truy c·∫≠p</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Content Section -->
  <section class="py-16 bg-white">
    <div class="max-w-7xl mx-auto px-4">
      
      <!-- Filter Section -->
      <TopikFilter categories={categories} />

      <!-- Documents Grid -->
      <TopikGrid documents={practiceDocuments} />
    </div>
  </section>
</TopikLayout>

