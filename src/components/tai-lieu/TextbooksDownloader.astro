---
// --- Props Interface ---
// Giao diện props không thay đổi.
export interface Props {
  downloadUrl: string;
  downloadOriginal?: string;
  downloadWorkbook?: string;
  downloadAudio?: string;
  downloadAnki?: string;
  fileSize: string;
  originalSize?: string;
  workbookSize?: string;
  audioSize?: string;
}

// --- Component Logic ---
const {
  downloadUrl,
  downloadOriginal,
  downloadWorkbook,
  downloadAudio,
  downloadAnki,
  fileSize,
  originalSize,
  workbookSize,
  audioSize,
} = Astro.props;

// --- SVG Icons ---
// Định nghĩa các icon SVG để sử dụng trong các nút bấm.
const icons = {
  book: `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" /></svg>`,
  hd: `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z" /></svg>`,
  workbook: `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>`,
  audio: `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" /></svg>`,
  anki: `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>`,
};

// Cấu trúc lại danh sách các mục tải xuống để bao gồm cả icon và màu gradient.
const downloadItems = [];

// Mục chính
downloadItems.push({
  href: downloadUrl,
  label: 'Giáo trình chính',
  size: fileSize,
  colorClasses: 'from-blue-500 to-blue-600',
  icon: icons.book,
});

// Các mục tùy chọn
if (downloadOriginal && originalSize) {
  downloadItems.push({
    href: downloadOriginal,
    label: 'Bản gốc HD',
    size: originalSize,
    colorClasses: 'from-green-500 to-green-600',
    icon: icons.hd,
  });
}
if (downloadWorkbook && workbookSize) {
  downloadItems.push({
    href: downloadWorkbook,
    label: 'Sách bài tập',
    size: workbookSize,
    colorClasses: 'from-purple-500 to-purple-600',
    icon: icons.workbook,
  });
}
if (downloadAudio && audioSize) {
  downloadItems.push({
    href: downloadAudio,
    label: 'File audio',
    size: audioSize,
    colorClasses: 'from-orange-500 to-orange-600',
    icon: icons.audio,
  });
}
if (downloadAnki) {
  downloadItems.push({
    href: downloadAnki,
    label: 'Bộ thẻ Anki',
    size: '1,486 thẻ',
    colorClasses: 'from-cyan-500 to-cyan-600',
    icon: icons.anki,
  });
}
---

<!-- --- Template --- -->
<div class="bg-slate-50 rounded-lg shadow p-5 sm:p-6 mb-6 border border-slate-200/80">
  <div class="text-center mb-4">
    <h2 class="text-xl sm:text-2xl font-bold text-slate-800">Tải xuống tài liệu</h2>
    <p class="text-slate-500 mt-1 text-sm">Chọn phiên bản tài liệu bạn cần</p>
  </div>
  <div class="max-w-3xl mx-auto">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
      <!-- Lặp qua danh sách để render các nút bấm -->
      {downloadItems.map(item => (
        <a
          href={item.href}
          class:list={[
            "download-btn group flex items-center justify-between text-white font-semibold p-3 rounded-lg shadow-sm transition-all duration-200 ease-in-out bg-gradient-to-r",
            item.colorClasses
          ]}
          target="_blank"
          rel="noopener noreferrer"
        >
          <div class="flex items-center gap-2">
            <Fragment set:html={item.icon} />
            <span class="text-sm">{item.label}</span>
          </div>
          <div class="flex items-center gap-2">
            <span class="text-xs font-medium opacity-90">{item.size}</span>
            <div class="download-icon-wrapper">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transition-transform duration-200 ease-in-out" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
              </svg>
            </div>
          </div>
        </a>
      ))}
    </div>
  </div>
</div>

<!-- --- Styles --- -->
<style>
  .download-btn {
    /* Hiệu ứng khi hover */
    
  }
  .download-btn:hover .download-icon-wrapper svg {
    transform: translateY(1px);
  }
</style>
